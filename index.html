<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skai Chocobunny | Digital Artist</title>
    
    <!-- FAVICON -->
    <link id="dynamic-favicon" rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üê∞</text></svg>">

    <!-- ESTILOS Y FUENTES -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;500;700&display=swap');
        
        body {
            font-family: 'Quicksand', sans-serif;
            background-color: #fff5f7;
        }

        .glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .gradient-text {
            background: linear-gradient(45deg, #ff85a1, #ffb7c5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            transition: all 0.3s ease;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fff5f7; }
        ::-webkit-scrollbar-thumb { background: #ffb7c5; border-radius: 10px; }
    </style>
</head>
<body class="text-gray-800">

    <!-- NAVIGATION -->
    <nav class="fixed w-full z-50 p-4">
        <div class="max-w-6xl mx-auto flex justify-between items-center glass rounded-full px-6 py-3 shadow-lg">
            <div class="text-2xl font-bold gradient-text">Skai Chocobunny</div>
            <div class="hidden md:flex space-x-8 font-medium">
                <a href="#home" class="hover:text-pink-400 transition">Home</a>
                <a href="#portfolio" class="hover:text-pink-400 transition">Portfolio</a>
                <a href="#commissions" class="hover:text-pink-400 transition">Commissions</a>
                <a href="#contact" class="hover:text-pink-400 transition">Contact</a>
                <button id="admin-login-btn" class="text-xs text-gray-400 hover:text-pink-500 underline">Admin</button>
            </div>
            <button class="md:hidden text-pink-500 text-2xl"><i class="fas fa-bars"></i></button>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section id="home" class="min-h-screen flex flex-col items-center justify-center text-center px-4 pt-20">
        <div class="mb-8 relative">
            <div class="w-48 h-48 md:w-64 md:h-64 rounded-full overflow-hidden border-8 border-white shadow-2xl mx-auto">
                <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Skai" alt="Skai Avatar" class="w-full h-full object-cover bg-pink-100">
            </div>
            <div class="absolute -bottom-4 -right-4 bg-white p-4 rounded-full shadow-lg">
                <span class="text-4xl">üé®</span>
            </div>
        </div>
        <h1 class="text-4xl md:text-6xl font-bold mb-4 gradient-text">Digital Illustrator & Character Designer</h1>
        <p class="text-lg md:text-xl text-gray-600 max-w-2xl mx-auto mb-8 leading-relaxed">
            Creating magical worlds, pastel aesthetics, and adorable characters. Bringing your imagination to life one pixel at a time.
        </p>
        <div class="flex space-x-4">
            <a href="#portfolio" class="bg-pink-400 text-white px-8 py-3 rounded-full font-bold shadow-lg hover:bg-pink-500 transition-all hover:scale-105">View Gallery</a>
            <a href="#commissions" class="bg-white text-pink-400 border-2 border-pink-400 px-8 py-3 rounded-full font-bold shadow-lg hover:bg-pink-50 transition-all">Order Now</a>
        </div>
    </section>

    <!-- PORTFOLIO SECTION (DYNAMIC) -->
    <section id="portfolio" class="py-20 px-4 bg-white/50">
        <div class="max-w-6xl mx-auto text-center">
            <h2 class="text-3xl md:text-5xl font-bold mb-12 gradient-text">Latest Works</h2>
            
            <!-- Gallery Grid -->
            <div id="gallery-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Las im√°genes cargadas desde Firebase aparecer√°n aqu√≠ -->
                <div class="col-span-full flex flex-col items-center justify-center py-20 text-gray-400">
                    <i class="fas fa-spinner fa-spin text-4xl mb-4"></i>
                    <p>Loading magical art...</p>
                </div>
            </div>
        </div>
    </section>

    <!-- COMMISSIONS (Simplified Example) -->
    <section id="commissions" class="py-20 px-4 bg-pink-100/30">
        <div class="max-w-4xl mx-auto text-center">
            <h2 class="text-3xl font-bold mb-12 gradient-text">Commission Info</h2>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-3xl shadow-xl card-hover">
                    <h3 class="text-xl font-bold mb-4 text-pink-400">Portrait</h3>
                    <p class="text-4xl font-bold mb-4">$45</p>
                    <ul class="text-gray-600 space-y-2 mb-6 text-left">
                        <li><i class="fas fa-check text-green-400 mr-2"></i> High resolution</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i> Simple background</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i> Full color</li>
                    </ul>
                </div>
                <div class="bg-white p-8 rounded-3xl shadow-xl card-hover">
                    <h3 class="text-xl font-bold mb-4 text-pink-400">Full Body</h3>
                    <p class="text-4xl font-bold mb-4">$85</p>
                    <ul class="text-gray-600 space-y-2 mb-6 text-left">
                        <li><i class="fas fa-check text-green-400 mr-2"></i> High resolution</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i> Detailed design</li>
                        <li><i class="fas fa-check text-green-400 mr-2"></i> 2 Revision phases</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- ADMIN PANEL OVERLAY -->
    <div id="admin-panel" class="fixed inset-0 bg-black/80 z-[60] hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl w-full max-w-2xl p-8 shadow-2xl relative overflow-y-auto max-h-[90vh]">
            <button onclick="document.getElementById('admin-panel').classList.add('hidden')" class="absolute top-4 right-4 text-2xl text-gray-400">&times;</button>
            <h2 class="text-2xl font-bold mb-6 gradient-text">Admin Dashboard</h2>
            
            <div id="login-form">
                <p class="mb-4 text-gray-600">Please enter your credentials to manage the portfolio.</p>
                <input type="email" id="admin-email" placeholder="Email" class="w-full p-3 border rounded-xl mb-4 outline-none focus:ring-2 ring-pink-300">
                <input type="password" id="admin-pass" placeholder="Password" class="w-full p-3 border rounded-xl mb-6 outline-none focus:ring-2 ring-pink-300">
                <button id="do-login" class="w-full bg-pink-400 text-white py-3 rounded-xl font-bold hover:bg-pink-500">Login</button>
            </div>

            <div id="admin-content" class="hidden">
                <div class="mb-8 p-4 bg-pink-50 rounded-2xl border border-pink-100">
                    <h3 class="font-bold mb-4">Add New Work</h3>
                    <input type="file" id="image-upload" accept="image/*" class="block w-full text-sm text-gray-500 mb-4 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-pink-50 file:text-pink-700 hover:file:bg-pink-100">
                    <input type="text" id="image-title" placeholder="Art Title" class="w-full p-3 border rounded-xl mb-4">
                    <button id="upload-btn" class="w-full bg-pink-400 text-white py-3 rounded-xl font-bold flex items-center justify-center space-x-2">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <span>Upload to Portfolio</span>
                    </button>
                    <div id="upload-status" class="mt-2 text-sm text-center font-medium"></div>
                </div>

                <h3 class="font-bold mb-4">Manage Current Art</h3>
                <div id="manage-grid" class="grid grid-cols-2 gap-4">
                    <!-- Art pieces with delete buttons -->
                </div>
            </div>
        </div>
    </div>

    <!-- FIREBASE & LOGIC -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, doc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getStorage, ref, uploadBytes, getDownloadURL, deleteObject } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-storage.js";

        const firebaseConfig = JSON.parse(window.__firebase_config);
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const storage = getStorage(app);
        const appId = window.__app_id || 'skai-portfolio';

        // 1. ESCUCHAR CAMBIOS EN LA COLECCI√ìN DE ARTE (Real-time Gallery)
        const artCollection = collection(db, 'artifacts', appId, 'public', 'data', 'artwork');
        const artQuery = query(artCollection, orderBy('createdAt', 'desc'));

        onSnapshot(artQuery, (snapshot) => {
            const gallery = document.getElementById('gallery-grid');
            const manageGrid = document.getElementById('manage-grid');
            
            if (snapshot.empty) {
                gallery.innerHTML = '<div class="col-span-full py-20 text-gray-400"><p>No work uploaded yet. Check back soon!</p></div>';
                manageGrid.innerHTML = '<p class="text-sm text-gray-400">No images found.</p>';
                return;
            }

            gallery.innerHTML = '';
            manageGrid.innerHTML = '';

            snapshot.forEach((docSnap) => {
                const art = docSnap.data();
                const id = docSnap.id;

                // Agregar a la galer√≠a p√∫blica
                gallery.innerHTML += `
                    <div class="group relative overflow-hidden rounded-3xl bg-pink-100 card-hover shadow-lg aspect-square">
                        <img src="${art.url}" alt="${art.title}" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                        <div class="absolute inset-0 bg-gradient-to-t from-pink-500/80 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex flex-col justify-end p-6 text-white text-left">
                            <h3 class="text-xl font-bold">${art.title || 'Untitled'}</h3>
                            <p class="text-sm opacity-80">Digital Illustration</p>
                        </div>
                    </div>
                `;

                // Agregar al panel de gesti√≥n (borrar)
                manageGrid.innerHTML += `
                    <div class="relative rounded-lg overflow-hidden border border-gray-200 aspect-square group">
                        <img src="${art.url}" class="w-full h-full object-cover">
                        <button onclick="deleteArt('${id}', '${art.storagePath}')" class="absolute inset-0 bg-red-500/40 opacity-0 group-hover:opacity-100 transition flex items-center justify-center text-white">
                            <i class="fas fa-trash-alt text-2xl"></i>
                        </button>
                    </div>
                `;
            });
        }, (error) => console.error("Error fetching gallery:", error));

        // 2. L√ìGICA DE SUBIDA
        document.getElementById('upload-btn').addEventListener('click', async () => {
            const fileInput = document.getElementById('image-upload');
            const titleInput = document.getElementById('image-title');
            const status = document.getElementById('upload-status');
            
            if (!fileInput.files[0]) {
                status.innerText = "‚ùå Please select a file first.";
                status.className = "mt-2 text-sm text-red-500";
                return;
            }

            const file = fileInput.files[0];
            const title = titleInput.value || "Untitled";
            const storagePath = `portfolio/${Date.now()}_${file.name}`;
            const storageRef = ref(storage, storagePath);

            try {
                status.innerText = "‚è≥ Uploading magical dust...";
                status.className = "mt-2 text-sm text-blue-500";

                const uploadResult = await uploadBytes(storageRef, file);
                const downloadURL = await getDownloadURL(uploadResult.ref);

                await addDoc(artCollection, {
                    title: title,
                    url: downloadURL,
                    storagePath: storagePath,
                    createdAt: serverTimestamp()
                });

                status.innerText = "‚ú® Successfully added to gallery!";
                status.className = "mt-2 text-sm text-green-500";
                fileInput.value = '';
                titleInput.value = '';
            } catch (error) {
                console.error(error);
                status.innerText = "‚ùå Error uploading: " + error.message;
                status.className = "mt-2 text-sm text-red-500";
            }
        });

        // 3. L√ìGICA DE BORRADO
        window.deleteArt = async (id, storagePath) => {
            if (!confirm("Are you sure you want to delete this piece?")) return;
            try {
                // Borrar de Firestore
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'artwork', id));
                // Borrar de Storage
                const storageRef = ref(storage, storagePath);
                await deleteObject(storageRef);
            } catch (error) {
                console.error("Delete failed:", error);
            }
        };

        // 4. L√ìGICA DE AUTH
        const adminBtn = document.getElementById('admin-login-btn');
        const adminPanel = document.getElementById('admin-panel');
        const loginForm = document.getElementById('login-form');
        const adminContent = document.getElementById('admin-content');

        adminBtn.addEventListener('click', () => adminPanel.classList.remove('hidden'));

        document.getElementById('do-login').addEventListener('click', async () => {
            const email = document.getElementById('admin-email').value;
            const pass = document.getElementById('admin-pass').value;
            try {
                await signInWithEmailAndPassword(auth, email, pass);
            } catch (e) {
                alert("Login failed: " + e.message);
            }
        });

        onAuthStateChanged(auth, (user) => {
            if (user) {
                loginForm.classList.add('hidden');
                adminContent.classList.remove('hidden');
            } else {
                loginForm.classList.remove('hidden');
                adminContent.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
